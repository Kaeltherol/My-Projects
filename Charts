def pareto_chart(series):
  import pandas as pd
  import matplotlib.pyplot as plt
  import numpy as np
  from matplotlib.ticker import PercentFormatter
  from tabulate import tabulate

  plt.style.use('fivethirtyeight')

  fig = plt.figure()
  ax = fig.add_subplot(1,1,1)

  s_count = series.value_counts()
  s_percent = series.value_counts(normalize = True)*100
  s_cum = s_percent.cumsum()

  ax.set_title('Pareto Chart of %s' % series.name)

  ax.bar(s_count.index,s_count, color ="C0")

  ax2 = ax.twinx()
  ax2.plot(s_cum.index,s_cum, color = 'C0', marker='D',ms=10 )
  ax2.yaxis.set_major_formatter(PercentFormatter())

  ax.tick_params(axis ='y', colors='C0')
  ax2.tick_params(axis ='y', colors='C1')

  ax.set_xticklabels(s_count.index,rotation = 75)

  ax.set_ylim(0,s_count.sum())
  ax2.set_ylim(0,110)

  ax.set_ylabel('Count', rotation =75)
  ax2.set_ylabel('Percent', rotation = 75)

  #for i, v in enumerate(s_cum):
    #ax2.text(i - 0.5, v + 3 , str('{:0.2f}'.format(v)), color='red', fontweight='bold')

  plt.subplots_adjust(bottom=0.5)

  plt.tight_layout()

  plt.show()

  row_labels=['Count','Percent','Cum']
  headers = [string for string in s_count.index]
  table = [s_count, s_percent, s_cum]
  tab = tabulate(table,headers = 'keys',tablefmt='grid', showindex=row_labels)

  print(tab)
